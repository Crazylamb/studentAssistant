<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta content="ie=edge" http-equiv="x-ua-compatible">
    <!--  Prevent admin panel being crawled by search engines -->
    <meta content="none, noarchive" name="robots">

    <title>Add Статус | Student Assistant</title>

    <!-- Font Awesome Icons -->
    <link href="/staticAdmin/vendor/fontawesome-free/css/all.min.css" rel="stylesheet">

    <!-- Bootstrap and adminLTE -->
    <link href="/staticAdmin/vendor/adminlte/css/adminlte.min.css" id="adminlte-css" rel="stylesheet">

    <!-- Bootswatch theme -->


    <!-- Custom fixes for django -->
    <link href="/staticAdmin/jazzmin/css/main.css" rel="stylesheet">


    <!-- favicons -->
    <link href="/staticAdmin/vendor/adminlte/img/AdminLTELogo.png" rel="shortcut icon" type="image/png">
    <link href="/staticAdmin/vendor/adminlte/img/AdminLTELogo.png" rel="icon" sizes="32x32" type="image/png">


    <!-- Google Font: Source Sans Pro -->
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">


    <link href="/staticAdmin/vendor/select2/css/select2.min.css" rel="stylesheet">


    <script src="/admin/jsi18n/" type="text/javascript"></script>
    <script src="/staticAdmin/admin/js/vendor/jquery/jquery.js"></script>
    <script src="/staticAdmin/admin/js/jquery.init.js"></script>
    <script src="/staticAdmin/admin/js/core.js"></script>
    <script src="/staticAdmin/admin/js/admin/RelatedObjectLookups.js"></script>
    <script src="/staticAdmin/admin/js/actions.js"></script>
    <script src="/staticAdmin/admin/js/urlify.js"></script>
    <script src="/staticAdmin/admin/js/prepopulate.js"></script>
    <script src="/staticAdmin/admin/js/vendor/xregexp/xregexp.js"></script>

</head>
<body class="hold-transition sidebar-mini sidebar-collapse  app-dashboard model-statuses change-form accent-primary theme-default "
      data-admin-utc-offset="0">

<div class="wrapper">


    <nav class="main-header navbar navbar-expand navbar-white navbar-light" id="jazzy-navbar">
        <ul class="navbar-nav">


            <li class="nav-item">
                <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
            </li>


            <li class="nav-item d-none d-sm-inline-block">

                <a class="nav-link" href="/admin/">Home</a>

            </li>

            <li class="nav-item d-none d-sm-inline-block">

                <a class="nav-link" href="http://84.201.175.11/" target="_blank">To the site</a>

            </li>

            <li class="nav-item d-none d-sm-inline-block">

                <a class="nav-link" href="/admin/auth/user/">Users</a>

            </li>

        </ul>


        <form action="/admin/auth/user/" class="form-inline ml-3" method="GET">
            <div class="input-group input-group-sm">
                <input aria-label="Search Users..." class="form-control form-control-navbar" name="q"
                       placeholder="Search Users..."
                       type="search">
                <div class="input-group-append">
                    <button class="btn btn-navbar" type="submit">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
        </form>

        <form action="/admin/auth/group/" class="form-inline ml-3" method="GET">
            <div class="input-group input-group-sm">
                <input aria-label="Search Groups..." class="form-control form-control-navbar" name="q"
                       placeholder="Search Groups..."
                       type="search">
                <div class="input-group-append">
                    <button class="btn btn-navbar" type="submit">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
        </form>


        <ul class="navbar-nav ml-auto">


            <li class="nav-item dropdown">
                <a class="nav-link btn" data-toggle="dropdown" href="#" title="admin">
                    <i aria-hidden="true" class="far fa-user"></i>
                </a>
                <div class="dropdown-menu dropdown-menu-lg dropdown-menu-left" id="jazzy-usermenu">
                    <span class="dropdown-header">Account</span>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="/admin/password_change/">
                        <i class="fas fa-key mr-2"></i> Change password
                    </a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="/admin/logout/">
                        <i class="fas fa-users mr-2"></i> Log out
                    </a>


                    <div class="dropdown-divider"></div>

                    <a class="dropdown-item dropdown-footer" href="/admin/auth/user/1/change/">See Profile</a>

                </div>
            </li>
        </ul>
    </nav>


    <aside class="main-sidebar elevation-4 sidebar-dark-primary" id="jazzy-sidebar">
        <a class="brand-link " href="/admin/" id="jazzy-logo">
            <img alt="Student Assistant Logo" class="img-circle brand-image elevation-3"
                 src="/staticAdmin/vendor/adminlte/img/AdminLTELogo.png" style="opacity: .8">
            <span class="brand-text font-weight-light">Student Assistant</span>
        </a>

        <div class="sidebar">
            <div class="user-panel mt-3 pb-3 mb-3 d-flex">
                <div class="image">

                    <i class="fas fa-inverse user-profile fa-user-circle"></i>

                </div>
                <div class="info">

                    <a class="d-block" href="/admin/auth/user/1/change/">admin</a>

                </div>
            </div>

            <nav class="mt-2">
                <ul class="nav nav-pills nav-sidebar flex-column " data-collapsible="false" data-widget="treeview"
                    role="menu">

                    <li class="nav-item">
                        <a class="nav-link" href="/admin/">
                            <i class="nav-icon fas fa-th-large"></i>
                            <p>Dashboard</p>
                        </a>
                    </li>


                    <li class="nav-header">Authentication and Authorization</li>

                    <li class="nav-item">

                        <a class="nav-link" href="/admin/auth/group/">
                            <i class="nav-icon fas fa-users"></i>
                            <p>Groups</p>
                        </a>

                    </li>

                    <li class="nav-item">

                        <a class="nav-link" href="/admin/auth/user/">
                            <i class="nav-icon fas fa-user"></i>
                            <p>Users</p>
                        </a>

                    </li>


                    <li class="nav-header">Dashboard</li>

                    <li class="nav-item">

                        <a class="nav-link" href="/admin/dashboard/projectstimetable/">
                            <i class="nav-icon fas fa-circle"></i>
                            <p>Дедлайны</p>
                        </a>

                    </li>

                    <li class="nav-item">

                        <a class="nav-link" href="/admin/dashboard/applications/">
                            <i class="nav-icon fas fa-circle"></i>
                            <p>Заявки</p>
                        </a>

                    </li>

                    <li class="nav-item">

                        <a class="nav-link" href="/admin/dashboard/users/">
                            <i class="nav-icon fas fa-circle"></i>
                            <p>Пользователи</p>
                        </a>

                    </li>

                    <li class="nav-item">

                        <a class="nav-link" href="/admin/dashboard/projects/">
                            <i class="nav-icon fas fa-circle"></i>
                            <p>Проекты</p>
                        </a>

                    </li>

                    <li class="nav-item">

                        <a class="nav-link" href="/admin/dashboard/userrecommendations/">
                            <i class="nav-icon fas fa-circle"></i>
                            <p>Рекомендации пользователям</p>
                        </a>

                    </li>

                    <li class="nav-item">

                        <a class="nav-link" href="/admin/dashboard/statuses/">
                            <i class="nav-icon fas fa-circle"></i>
                            <p>Статусы</p>
                        </a>

                    </li>

                    <li class="nav-item">

                        <a class="nav-link" href="/admin/dashboard/categories/">
                            <i class="nav-icon fas fa-circle"></i>
                            <p>Теги</p>
                        </a>

                    </li>

                    <li class="nav-item">

                        <a class="nav-link" href="/admin/dashboard/usercategories/">
                            <i class="nav-icon fas fa-circle"></i>
                            <p>Теги пользователей</p>
                        </a>

                    </li>

                    <li class="nav-item">

                        <a class="nav-link" href="/admin/dashboard/projectcategories/">
                            <i class="nav-icon fas fa-circle"></i>
                            <p>Теги проектов</p>
                        </a>

                    </li>

                    <li class="nav-item">

                        <a class="nav-link" href="/admin/dashboard/faculties/">
                            <i class="nav-icon fas fa-circle"></i>
                            <p>Факультеты</p>
                        </a>

                    </li>

                    <li class="nav-item">

                        <a class="nav-link" href="/admin/email">
                            <i class="nav-icon fas fa-comments"></i>
                            <p>Уведомления</p>
                        </a>

                    </li>


                </ul>
            </nav>
        </div>
    </aside>


    <div class="content-wrapper">


        <div class="content border-bottom mb-2">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12 col-md-auto d-flex flex-grow-1 align-items-center">
                        <h1 class="h4 m-0 pr-3 mr-3 border-right"> Уведомления </h1>

                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="/admin/">Home</a></li>
                            <li class="breadcrumb-item"><a href="/admin/dashboard/">Dashboard</a></li>
                            <li class="breadcrumb-item active">
                                Отправить уведомление
                            </li>
                        </ol>

                    </div>

                </div>
            </div>
        </div>


        <div class="content">
            <div class="container-fluid">
                <section class="content" id="content">


                    <div class="row">


                        <div class="col-12" id="content-main">
                            <form action="" id="my-form" method="post" novalidate>
                                {% csrf_token %}
                                <div class="row">
                                    <div class="col-12 col-lg-9">
                                        <div class="card">
                                            <div class="card-body">
                                                <div class="form-group field-email">
                                                    <div class="row">
                                                        <label class="col-sm-3 text-left">
                                                            Email
                                                            <span class="text-red">* </span>
                                                        </label>
                                                        <div class=" col-sm-7 field-email ">
                                                            <select class="col-sm-7 select2" id="dropdown1" multiple
                                                                    name="emails[]">
                                                                {% for option in emails %}
                                                                <option value="{{ option.id }}">{{ option.email }}
                                                                </option>
                                                                {% endfor %}
                                                            </select>

                                                            <select class="col-sm-7 select2" id="dropdown2" multiple
                                                                    name="faculties[]">
                                                                {% for option in faculties %}
                                                                <option value="{{ option.id }}">{{ option.name }}
                                                                </option>
                                                                {% endfor %}
                                                            </select>
                                                            <div class="help-block red">
                                                            </div>
                                                            <div class="help-block text-red">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group field-topic">
                                                    <div class="row">
                                                        <label class="col-sm-3 text-left" for="id_topic">
                                                            Topic
                                                            <span class="text-red">* </span>
                                                        </label>
                                                        <div class=" col-sm-7 field-email ">
                                                            <textarea class="vLargeTextField" cols="40" id="id_topic"
                                                                      name="topic" required rows="10"></textarea>
                                                            <div class="help-block red">
                                                            </div>
                                                            <div class="help-block text-red">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group field-message">
                                                    <div class="row">
                                                        <label class="col-sm-3 text-left" for="id_message">
                                                            Message
                                                            <span class="text-red">* </span>
                                                        </label>
                                                        <div class=" col-sm-7 field-email ">
                                                            <textarea class="vLargeTextField" cols="40" id="id_message"
                                                                      name="message" required rows="10"></textarea>
                                                            <div class="help-block red">
                                                            </div>
                                                            <div class="help-block text-red">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>


                                                <div class="col-12 col-lg-3">
                                                    <div class="" id="jazzy-actions">


                                                        <div>

                                                            <div class="form-group">
                                                                <div class="submit-row">
                                                                    <input class="btn btn-info form-control" id="Send"
                                                                           type="Submit"
                                                                           value="Send Message">
                                                                </div>
                                                                <div id="my-message"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>



                                                <script data-prepopulated-fields="[]"
                                                        id="django-admin-prepopulated-fields-constants"
                                                        src="/staticAdmin/admin/js/prepopulate_init.js">
                                                </script>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>


                    </div>
                </section>
            </div>
        </div>


    </div>


    <footer class="main-footer ">
        <div class="float-right d-none d-sm-inline">
            <b>Jazzmin version</b> 2.6.0
        </div>

        <strong>Copyright &copy; 2023 .</strong> All rights reserved.

    </footer>


</div>


<!-- jQuery -->
<script src="/staticAdmin/admin/js/vendor/jquery/jquery.js"></script>
<!-- Bootstrap 4 -->
<script src="/staticAdmin/vendor/bootstrap/js/bootstrap.min.js"></script>
<!-- AdminLTE App -->
<script src="/staticAdmin/vendor/adminlte/js/adminlte.min.js"></script>
<!-- Django customisations -->
<script src="/staticAdmin/jazzmin/js/main.js"></script>


<script src="/staticAdmin/vendor/select2/js/select2.min.js" type="text/javascript"></script>
<script src="/staticAdmin/jazzmin/js/change_form.js" type="text/javascript"></script>

<script type="text/javascript">
    $(document).ready(function() {
      $('.select2').select2({
        minimumResultsForSearch: Infinity,
        placeholder: "Select an option or type to search",
        allowClear: true,
        tags: true,
        tokenSeparators: [',', ' ']
      });
    });





</script>
<script type="text/javascript">
  $(document).ready(function() {
    // get the radio buttons and dropdowns
    var radioButtons = $('input[name="dropdownType"]');
    var dropdown1 = $('#dropdown1');
    var dropdown2 = $('#dropdown2');

    // add change event listener to the radio buttons
    radioButtons.change(function() {
      if (this.value === 'dropdown1') {
        dropdown1.show();
        dropdown2.hide();
      } else if (this.value === 'dropdown2') {
        dropdown1.hide();
        dropdown2.show();
      }
    });
  });




</script>
<script>
  $(document).ready(function() {
    // get the dropdowns and email field
    var dropdown1 = $('#dropdown1');
    var dropdown2 = $('#dropdown2');
    var emailField = $('#id_email');

    // add click event listener to the button
    $('#selectValueButton').click(function() {
      var selectedOptions = [];

      if (dropdown1.is(':visible')) {
        dropdown1.find('option:selected').each(function() {
          selectedOptions.push($(this).text());
        });
      } else if (dropdown2.is(':visible')) {
        dropdown2.find('option:selected').each(function() {
          selectedOptions.push($(this).text());
        });
      }

if (selectedOptions.length > 0) {
      // get existing email text and split into lines
      var emailText = emailField.val();
      var lines = emailText.trim().split('\n');

      // check if selected options already exist in email field
      var lastLine = lines[lines.length - 1];
      var existingOptions = lastLine.split('; ');
      var newOptions = selectedOptions.filter(function(option) {
        return existingOptions.indexOf(option) === -1;
      });

      if (newOptions.length > 0) {
        // add new selected options to last line
        var separator = lastLine.length > 0 ? '; ' : '';
        lines[lines.length - 1] = lastLine + separator + newOptions.join('; ');

        // set modified text to email field
        emailField.val(lines.join('\n'));
      }
    }
    });
  });



</script>

<script>
  $('#Send').on('click', function(event) {
  event.preventDefault(); // prevent default form submission behavior
  var formData = $('#my-form').serializeArray();
    var emails = $('#dropdown1 option:selected').map(function() { return $(this).text(); }).get();
    var faculties = $('#dropdown2 option:selected').map(function() { return $(this).text(); }).get();
  formData.push({name: 'emails', value: emails});
  formData.push({name: 'faculties', value: faculties});
  $.ajax({
    url: 'send_email',
    method: 'POST',
    data: formData,
    success: function(response) {
      $('#my-message').text('Message sent successfully!');
      $('#my-message').addClass('success');
      setTimeout(function() {
        $('#my-message').removeClass('success');
        $('#my-message').text('');
      }, 5000);
      $('#id_email, #id_topic, #id_message').val('');
    },
    error: function(jqXHR, textStatus, errorThrown) {
      $('#my-message').text('Message failed to send.');
      $('#my-message').addClass('error');
            setTimeout(function() {
        $('#my-message').removeClass('error');
        $('#my-message').text('');
      }, 5000);
    }
  });
});
</script>


</body>
</html>
